> :information_source: This is a trimmed draft of where we are attempting to take [ERC-7715](https://eip.tools/eip/7715). Please rely on this for internal development and expect it to be maintained and accurate.

### Signer types

```typescript
type KeySigner = {
  type: "key";
  data: {
    type: "secp256r1"; // supports both passkeys and cryptokeys
    publicKey: `0x${string}`;
  };
};

type AccountSigner = {
  type: "account";
  data: {
    address: `0x${string}`; // supports both EOAs and smart contracts
  };
};
```

### Permission types

```tsx
type NativeTokenRecurringAllowancePermission = {
  type: "native-token-recurring-allowance";
  data: {
    start: number; // unix seconds
    period: number; // seconds
    allowance: `0x${string}`; // hex for uint256
  };
};

type AllowaedContractSelectorPermission = {
  type: "allowed-contract-selector";
  data: {
    contract: `0x${string}`; // address
    selector: `0x${string}`; // bytes4 function selector
  };
};
```

### Sample `wallet_grantPermissions` request `params`

```tsx
const request = {
  method: "wallet_grantPermissions",
  params: [
    {
      chainId: "0x14A34", // 84532, base sepolia
      address: "0x...", // optional
      expiry: 1725000000,
      signer: {
        type: "key",
        data: {
          type: "secp256r1",
          publicKey: "0x...",
        },
      },
      permissions: [
        {
          type: "native-token-recurring-allowance",
          data: {
            start: 1724264802,
            period: 86400, // 1 day in seconds
            allowance: `0x1`, // 1 wei
          },
        },
        {
          type: "allowed-contract-selector",
          data: {
            contract: "0x8Af2FA0c32891F1b32A75422eD3c9a8B22951f2F", // Click
            selector: "0x2bd1b86d", // permissionedCall(bytes)
          },
        },
      ],
    },
  ],
};
```

### Sample `wallet_grantPermissions` response `result`

```tsx
[
  {
    request: {
      chainId: "0x14A34", // 84532, base sepolia
      address: "0x...", // optional
      expiry: 1725000000,
      signer: {
        type: "key",
        data: {
          type: "secp256r1",
          publicKey: "0x...",
        },
      },
      permissions: [
        {
          type: "native-token-recurring-allowance",
          data: {
            start: 1724264802,
            period: 86400, // 1 day in seconds
            allowance: `0x1`, // 1 wei
          },
        },
        {
          type: "allowed-contract-selector",
          data: {
            contract: "0x8Af2FA0c32891F1b32A75422eD3c9a8B22951f2F", // Click
            selector: "0x2bd1b86d", // permissionedCall(bytes)
          },
        },
      ],
    },
    context: "0x...",
  },
];
```

### Permission State types

```tsx
type NativeTokenRecurringAllowancePermissionState = {
  cycleStart: number;
  cycleEnd: number;
  spent: Hex; // uint256
  spendLeft: Hex; // uint256
};
```

### Get Permission RPC types

```tsx
type GetPermissionsRequest = {
  address: Hex; // same as PermissionRequest.account
  chainId: Hex;
  signerId: string; // RFC-8785 hash of PermissionRequest.signer
};

type GetPermissionsResponse = PermissionReponse & {
  currentState: Record<string, Record<string, any>>; // permission type => object
};
```

### Sample `wallet_getPermissions` request `params`

```tsx
{
  "address": "0x...",
  "chainId": "0x...",
  "signerId": ""
}
```

### Sample `wallet_getPermissions` response `result`

```tsx
[
  {
    request: {
      chainId: "0x14A34", // 84532, base sepolia
      address: "0x...", // optional
      expiry: 1725000000,
      signer: {
        type: "key",
        data: {
          type: "secp256r1",
          publicKey: "0x...",
        },
      },
      permissions: [
        {
          type: "native-token-recurring-allowance",
          data: {
            start: 1724264802,
            period: 86400, // 1 day in seconds
            allowance: `0x1`, // 1 wei
          },
        },
        {
          type: "allowed-contract-selector",
          data: {
            contract: "0x8Af2FA0c32891F1b32A75422eD3c9a8B22951f2F", // Click
            selector: "0x2bd1b86d", // permissionedCall(bytes)
          },
        },
      ],
    },
    context: "0x...",
    currentState: {
      "native-token-recurring-allowance": {
        cycleStart: 1724264802,
        cycleEnd: 1724351202,
        spent: `0x0`,
        spendLeft: `0x1`,
      },
    },
  },
];
```
